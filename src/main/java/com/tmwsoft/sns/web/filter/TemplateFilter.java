package com.tmwsoft.sns.web.filter;import java.io.File;import java.io.IOException;import java.io.OutputStream;import javax.servlet.Filter;import javax.servlet.FilterChain;import javax.servlet.FilterConfig;import javax.servlet.ServletException;import javax.servlet.ServletRequest;import javax.servlet.ServletResponse;import javax.servlet.http.HttpServletRequest;import javax.servlet.http.HttpServletResponse;import com.tmwsoft.sns.util.Common;import com.tmwsoft.sns.util.SysConstants;public class TemplateFilter implements Filter {	public void destroy() {	}	public void doFilter(ServletRequest req, ServletResponse res, FilterChain chain) throws IOException,			ServletException {				HttpServletRequest request = (HttpServletRequest) req;		HttpServletResponse response = (HttpServletResponse) res;		String sp = request.getServletPath();// /template/xxxxxxxx/xxxxx		String snsRoot = SysConstants.snsRoot;		String filePath = snsRoot + sp;		// 首先判断当前模板请求的文件存在不,/template/xxxxxxxx/xxxxx		File file = new File(filePath);		if(!file.exists()) {			// 当前模板请求的文件不存在，到default模板中查找/template/default			String[] paths = sp.split("/");			// [,template,xxxxxxxx,xxxxx]			paths[2] = "default";			sp = "";			for(String path : paths) {				sp += "/" + path;			}			filePath = snsRoot + sp;			file = new File(filePath);			if(!file.exists()) {				// 找不到请求的文件				return;			}		}		response.reset();		OutputStream output = response.getOutputStream();		Common.copyFileToOutputStream(filePath, output);	}	public void init(FilterConfig arg0) throws ServletException {	}}